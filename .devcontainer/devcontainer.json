{
  "name": "Flutter (Campsite Nav)",
  "image": "mcr.microsoft.com/devcontainers/base:ubuntu",

  // Verbesserter Befehl zur manuellen Installation von Flutter
  // set -e: Bricht bei Fehlern ab; set -x: Zeigt ausgefÃ¼hrte Befehle im Log
  "postCreateCommand": "set -e && set -x && sudo apt-get update && sudo apt-get install -y --no-install-recommends git curl unzip xz-utils zip libglu1-mesa ca-certificates && git clone https://github.com/flutter/flutter.git -b stable /usr/local/flutter && sudo chown -R vscode:vscode /usr/local/flutter && echo 'export PATH=\"/usr/local/flutter/bin:$PATH\"' >> /home/vscode/.bashrc && sudo -u vscode --preserve-env=PATH env PATH=\"/usr/local/flutter/bin:$PATH\" flutter precache",

  // Ports bleiben gleich
  "forwardPorts": [8080, 9100],
  "portsAttributes": {
    "8080": {
      "label": "Flutter App (Web)",
      "onAutoForward": "openPreview"
    },
    "9100": {
      "label": "Dart DevTools",
      "onAutoForward": "silent"
    }
  },

  // VS Code Anpassungen (jetzt wieder mit explizitem SDK-Pfad)
  "customizations": {
    "vscode": {
      "settings": {
         // Pfad explizit setzen, da wir ihn im postCreateCommand festlegen
        "dart.flutterSdkPath": "/usr/local/flutter"
      },
      "extensions": [
        "Dart-Code.dart-code",
        "Dart-Code.flutter",
        "GitHub.codespaces",
        "GitHub.vscode-pull-request-github"
      ]
    }
  },

  "remoteUser": "vscode"
}